📃 模块概述
===================================

gotrackit中包括了五大模块：

* `路网生产与优化`_

* `轨迹生产`_

* `轨迹处理`_

* `地图匹配`_

* `时空可视化`_


.. _路网生产与优化:


路网生产与优化
--------------------

路网生产
```````````````````````

路网生产工具用于帮助用户获取路网数据，以及对路网数据进行各种检查与优化，你只需寥寥几行代码便可以获得路网数据。


.. note::

   该路网获取方式利用的是高德开放平台的官方API - 路径规划接口，不涉及爬虫抓包！


.. note::

   任何非官方采购形式的路网获取方法都不可能获得完整的路网数据！


.. note::

   依据本开源包的开源协议：通过该方式获取的路网数据严禁用于商业行为，仅限于教育以及科学研究课题，如有商用需求请联系高德客服进行路网采购，感谢高德开放平台的免费接口！

.. note::

   本开源包获取路网的原理，和OSM之类的平台获取路网的原理，是不一样的：

   1.osm是库里已有路网，用户框选获取属于查询获取；

   2.gotrackit是基于路径规划API接口返回的路径进行分析计算，从而获取路网。所以OD构造的精度和数量直接决定了路网的完整度！请留意构造OD的方式和OD数量。

路网生产的主要流程为：依据研究区域范围构造OD --> 基于OD请求路径规划 --> 基于路径规划结果执行空间优化实现路网逆向

.. image:: _static/images/netreverse_tech_way.png
    :align: center

--------------------------------------------------------------------------------

本开源包将相关的方法都封装为了标准函数接口，您只用提供一个key便可以进行中国境内任意区域路网的获取。


* 构造OD
    提供基于任意形状区域随机构造OD的方法；

    提供基于地块构造形心出行OD的方法；

    提供基于GPS数据精准构造带途径点OD的方法；

    支持自定义构造OD。

.. _od_type:

.. image:: _static/images/od_gen.png
    :align: center

--------------------------------------------------------------------------------

三张图分别对应od_type参数为rand_od、region_od、gps_based

构造OD非常重要，因为OD构造的越精准，路径规划所覆盖的道路路段就越全面，我们得到的路网覆盖率就越高。

.. _OD表要求:

如果您需要使用自定义OD，请提供以下字段要求的OD表：

.. csv-table:: OD表字段说明
    :header: "字段名称", "字段类型", "字段说明"
    :widths: 15, 5, 40

    "od_id","int","OD唯一编码，不允许为空"
    "o_x","float","起点经度，不允许为空，GCJ-02坐标系"
    "o_y","float","起点纬度，不允许为空，GCJ-02坐标系"
    "d_x","float","终点经度，不允许为空，GCJ-02坐标系"
    "d_y","float","终点纬度，不允许为空，GCJ-02坐标系"
    "hh","int","请求时段(0~23)，如果对每个OD有具体的请求时段限制，请确保有该列，且将ignore_hh置为False，不允许有空值；如果没有时段限制, 该列可以不提供"
    "way_points","string","途径点坐标串，最多支持10个途径点，允许为空值"

样例OD数据如下：

.. csv-table:: OD样例数据
    :header: "od_id", "o_x", "o_y", "d_x", "d_y", "way_points"
    :widths: 3, 5, 5, 5, 5, 10

    "1","120.73054930354505","31.672649340942495","120.73338512634608","31.667515168299673","120.73176445980103,31.6705214428833"
    "2","120.73050669059927","31.666431974714015","120.74717247617396","31.669917988588765","120.73119124695165,31.666929583950083;120.7380010705855,31.66916745090122"
    "3", "120.74229535581601","31.660716341555","120.74250979515529","31.652820575113125",""

--------------------------------------------------------------------------------


* 路径规划请求
    您只需要申请一个 `开发者key <https://lbs.amap.com>`_ ；

    支持自由请求、按照时段请求。


* 空间优化
    路径拆分：基于路径拓扑点拆分最小路段；

    拓扑关联：生产点层，添加拓扑关系；

    路段拓扑优化：以一定的限制规则将路段进行合并，支持属性限制、累计长度限制、最大转角限制、环检测；

    重叠路段识别：部分路径距离非常近，但是却没有完全重合，本包可以进行识别与优化；

    联通性校准：识别路网中潜在的不连通节点并进行处理。


路网优化
```````````````````````

路网优化工具用于帮助用户从已有的路网线层数据创建标准的gotrackit路网。


路网生产与优化具体的代码实操见 :doc:`路网生产与优化`


.. _轨迹生产:

轨迹生产
--------------------

该模块依托路网文件模拟车辆行驶并且产生GPS数据，当用户没有实际GPS数据时可以借助该模块生产GPS数据。


基本流程为：

.. image:: _static/images/GpsGenGraph.png
    :align: center

----------------------------------------

具体的代码实操见 :doc:`轨迹生产`


.. _轨迹处理:

轨迹处理
--------------------

可以对GPS轨迹数据进行 行程切分、轨迹平滑等操作，具体的代码实操见  :doc:`轨迹处理`


.. _地图匹配:

地图匹配
--------------------

依托路网文件、GPS数据，对GPS数据进行地图匹配，匹配结果给出每个GPS点实际的匹配路段信息。

基本流程为：

.. image:: _static/images/MatchGraph.png
    :align: center

----------------------------------------

gotrackit匹配接口支持直接输出匹配过程动态可视化网页，地图匹配接口指定export_html=True时，在地图匹配结束后将匹配结果统一输出到HTML文件，用户可以使用浏览器打开该文件播放匹配动画。


具体的代码实操见  :doc:`地图匹配`




.. _时空可视化:

时空可视化
--------------------

gotrackit封装了部分kepler的接口，您可以直接使用该接口对你的数据进行可视化。

具体的代码实操见  :doc:`时空可视化`
